<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PaySafe Payment System</title>

  <!-- Bootstrap CDN -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
</head>

<body class="bg-light">

  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-md-6">

        <div class="card shadow">
          <div class="card-header text-center fw-bold">
            PaySafe Payment System
          </div>

          <div class="card-body text-center">

            <p class="text-muted">
              Demonstrating Canary & Blue-Green Deployments
            </p>

            <button id="payBtn" class="btn btn-primary" onclick="makePayment()">
              Make Payment
            </button>

            <div id="result" class="mt-4"></div>

          </div>
        </div>

      </div>
    </div>
  </div>

<script>
  function makePayment() {
    const btn = document.getElementById("payBtn");
    const result = document.getElementById("result");

    btn.disabled = true;
    btn.innerText = "Processing...";

    fetch("/api/pay", { method: "POST" })
      .then(response => response.json())
      .then(data => {
        let color = data.status === "SUCCESS" ? "success" : "danger";

        result.innerHTML = `
          <div class="alert alert-${color}">
            <h5>Status: ${data.status}</h5>
            <p>${data.message}</p>
          </div>
        `;
      })
      .catch(() => {
        result.innerHTML = `
          <div class="alert alert-danger">
            Backend not reachable
          </div>
        `;
      })
      .finally(() => {
        btn.disabled = false;
        btn.innerText = "Make Payment";
      });
  }
</script>

</body>
</html>

